# DepMap Internal 21Q1

##############
## Overview ##
##############

This DepMap release contains data from CRISPR knockout screens from project Achilles, as well as genomic characterization data from the CCLE project.

###############
## Pipelines ##
###############

### Achilles

This Achilles dataset contains the results of genome-scale CRISPR knockout screens for <ACHILLES_TEMPLATE (18,119 in 20q4)> genes in <ACHILLES_TEMPLATE (896 in 20q4)> cell lines. Please note that not all cell lines have had fingerprinting completed at the time of release. Some are being released provisionally pending fingerprinting results. The dataset was processed using the following steps:

- Sum raw readcounts by replicate and guide
- Remove the list of guides with suspected off-target activity
- Remove guides with pDNA counts less than one millionth of the pDNA pool
- Remove replicates that fail fingerprinting match to parent or derivative lines
- Remove replicates with total reads less than 15 million
- Calculate reads per million, add pseudo-count of 1, then log2-fold-change from pDNA counts for each replicate
- Calculate the NNMD for each replicate using genes targeting the Hart reference non-essentials and the intersection of the Hart and Blomen essentials, and remove those with values more positive than -1.0. See Hart et al., Mol. Syst. Biol, 2014 and Blomen et al., Science, 2015
- Remove replicates that do not have a Pearson coefficient > .61 with at least one other replicate for the line when looking at genes with the highest variance (top 3%) in gene effect across cell lines. Equivalent to excluding lines whose replicates have a p-value greater than 0.05 of having at least as high a correlation with a random line as with each other. 
- Calculate the NNMD for each cell line after averaging remaining replicates, and remove those more positive than -1.0
- Run CERES to generate gene-level scores
- Scale so the median of common essentials in each cell lines is -1
- Remove the mean and variance of each gene across datasets, so each gene has mean 0 and variance 1
- Remove the first five principle components of the resulting matrix and restore the prior means of genes
- Scale again so the median of common essentials in each cell lines is -1
- Identify pan-dependent genes as those for whom 90% of cell lines rank the gene above a given dependency cutoff. The cutoff is determined from the central minimum in a histogram of gene ranks in their 90th percentile least dependent line
- For each CERES gene score, infer the probability that the score represents a true dependency or not. This is done using an EM step until convergence independently in each cell line. The dependent distribution is given by the list of essential genes. The null distribution is determined from unexpressed gene scores in those cell lines that have expression data available, and from the Hart non-essential gene list in the remainder
- Genes with no unique guides are dropped from all post-CERES files due to inaccurate gene scores  
- Replace all genes on X chromosome for cell lines that only have Broad SNP copy number data with NA in gene_effect.csv, gene_effect_unscaled.csv, and gene_dependency.csv
- 1,309 genes are NA-ed in 12 cell lines due to identified contamination. New data for these cell lines will be generated in the future

The source for copy number data varies by cell line. Copy number data indicated as "Sanger WES" are based on the Sanger Institute whole exome sequencing data (COSMIC: http://cancer.sanger.ac.uk/cell_lines, EGA accession number: EGAD00001001039) reprocessed using CCLE pipelines. Copy number source was chosen according to the following logic:

- Broad WES for lines where available
- Broad SNP when Broad WES is not available and Sanger WES not available, or Sanger WES copy number has less correlation with logfold change than Broad SNP
- Sanger WES in all other cases

Details about data processing are published on bioRxiv here: https://www.biorxiv.org/content/10.1101/720243v1


### Expression

CCLE expression data is quantified from RNAseq files using the GTEx pipelines. A detailed description of the pipelines and tool versions can be found here: https://github.com/broadinstitute/ccle_processing#rnaseq. We provide a subset of the data files outputted from this pipeline available on FireCloud. These are aligned to hg38.

### Copy number

CCLE WES copy number data is generated by running the GATK copy number pipeline aligned to hg38. Tutorials and descriptions of this method can be found here https://software.broadinstitute.org/gatk/documentation/article?id=11682, https://software.broadinstitute.org/gatk/documentation/article?id=11683. WES samples have been realigned to hg38 and run through this pipeline.

### Mutations

CCLE mutation calls are aggregated from several different sources and sequencing technologies.

### Fusions

CCLE generates RNAseq based fusion calls using the STAR-Fusion pipeline. A comprehensive overview of how the STAR-Fusion pipeline works can be found here: https://github.com/STAR-Fusion/STAR-Fusion/wiki. We run STAR-Fusion version 1.6.0 using the plug-n-play resources available in the STAR-Fusion docs for gencode v29. We run the fusion calling with default parameters except we add the --no_annotation_filter and --min_FFPM 0 arguments to prevent filtering.

###################
## Omics Updates ##
###################

- [Expression] Updated the gene annotations used. The latest version of annotations (v102) from ensembl's biomart was used: http://useast.ensembl.org/Homo_sapiens/Info/Annotation (likely updating the number of genes will change in our gene expression files as compared to previous versions).
- [Expression] A handful of genes were duplicated in the CCLE_expression file due to multiple transcripts mapping to the same gene name (i.e. PINX1 and TBCE plus 12 noncoding genes). We consolidated them by addition of their TPM values.
- [Expression] Found a wrong expression profile for ACH-001321, it was the one of ACH-000561. Added back the right expression profile for ACH-001321.

- [Fusion] Updated the fusion pipeline to STAR-Fusion:1.7.0 for the new RNAseq data which was missing fusion calls (from 20q4 and 21q1).

- [CN] In 21Q1 we introduced copy number data derived from WGS data where available. We prioritize WGS data for estimating copy number data when multiple data sources are available (e.g. WES, SNP array). Note that WGS copy number data were included in the initial 20Q4 release, but we discovered several issues with the WGS copy number pipeline which we addressed in 21Q1. These WGS copy number data were removed from 20Q4 as part of the data correction.
- [CN] Y chromosome CN data is new (was part of initial 20Q4 data reverted) (now normal male/female X chromosome is reported as 0.5/1 and normal male Y chromosome as 0.5).
- [CN] Removed 'chr' chromosome prefix in seg CN file.
- [CN] We are now adding amplification status (-, 0, +)  for each segment in the segment copy number. X chromosome amplification status was removed due to its bias in female samples, caused by our purely male PoNs.
- [CN] Copy Number calls for the normal sample ACH-002359, were removed in 21Q1. We plan to add the data back in 21Q2.

- [CN+Mutations] Removed lines that should have been removed in 20Q4 ACH-001189, ACH-002303, ACH-002315, ACH-002341.
- [CN+Mutations] Warning: Keeping 3 Chordoma lines that dramatically failed our WES QC: "ACH-001955", “ACH-001956”, "ACH-001957".

###########
## Files ##
###########

### Achilles_gene_effect_unscaled.csv
Pipeline: Achilles

_Post-CERES_

CERES inferred effects of knocking out genes, without additional scaling. More negative effects produce more negative logfold changes.

- Columns: genes in the format “HUGO (Entrez)”
- Rows: cell lines (Broad IDs)

### Achilles_gene_effect.csv
Pipeline: Achilles

_Post-CERES_

CERES data with principle components strongly related to known batch effects removed, then shifted and scaled per cell line so the median nonessential KO effect is 0 and the median essential KO effect is -1.

- Columns: genes in the format “HUGO (Entrez)”
- Rows: cell lines (Broad IDs)

### Achilles_gene_dependency.csv
Pipeline: Achilles

_Post-CERES_

Probability that knocking out the gene has a real depletion effect using gene_effect.

- Columns: genes in the format “HUGO (Entrez)”
- Rows: cell lines (Broad IDs)

### Achilles_guide_efficacy.csv
Pipeline: Achilles

_Post-CERES_

Columns:

- sgrna (nucleotides)
- efficacy - CERES inferred efficacy for the guide

### Achilles_common_essentials.csv
Pipeline: Achilles

_Post-CERES_

List of genes identified as dependencies in all lines, one per line.

### common_essentials.csv
Pipeline: Achilles

_Pre-CERES file_

List of genes used as positive controls, intersection of Biomen (2014) and Hart (2015) essentials in the format “HUGO (Entrez)”. Each entry is separated by a newline.
The scores of these genes are used as the dependent distribution for inferring dependency probability.

### nonessentials.csv
Pipeline: Achilles

_Pre-CERES file_

List of genes used as negative controls (Hart (2014) nonessentials) in the format “HUGO (Entrez)”. Each entry is separated by a newline.

### Achilles_raw_readcounts.csv
Pipeline: Achilles

_Pre-CERES file_

Summed counts for each replicate/PDNA

- Columns: replicate/pDNA IDs
- Rows: Guides (nucleotides)

### Achilles_raw_readcounts_failures.csv
Pipeline: Achilles

_Pre-CERES file_

Summed counts for each replicate failing quality control checks

- Columns: replicate IDs
- Rows: Guides (nucleotides)

### Achilles_logfold_change.csv
Pipeline: Achilles

_Pre-CERES file_

Post-QC log2-fold change (not ZMADed)

- Columns: replicate IDs
- Rows: Guides (nucleotides)

### Achilles_logfold_change_failures.csv
Pipeline: Achilles

_Pre-CERES file_

Post-QC log2-fold change (not ZMADed) for cell lines failing quality control checks

- Columns: replicate IDs
- Rows: Guides (nucleotides)


### Achilles_guide_map.csv
Pipeline: Achilles

_Pre-CERES file_

Columns:

- sgrna (nucleotides) - appears more than once
- genome_alignment
- gene (“HUGO (Entrez)”)
- n_alignments (integer number of perfect matches for that guide)

### Achilles_replicate_map.csv
Pipeline: Achilles

_Pre-CERES file_

Columns:

- replicate_ID (str)
- Broad_ID
- pDNA_batch (int): indicates which processing batch the replicate belongs to and therefore which pDNA reference it should be compared with.
- passes_QC (str): indicates if the replicate was included in CERES calculations 

### Achilles_dropped_guides.csv
Pipeline: Achilles

_Pre-CERES file_

Columns:

- sgrna (nucleotides) - appears more than once
- genome_alignment
- gene (“HUGO (Entrez)”)
- n_alignments (integer number of perfect matches for that guide)
- fail_reason (why this guide is not used for gene effect/dependency calculation) Note: in_dropped_guides = guide dropped for suspected off-target activity

### Achilles_high_variance_genes.csv
Pipeline: Achilles

_Pre-CERES file_

List of genes with top 3% most variable scores across cell lines in 18Q4 gene_effect. Used for replicate correlation in quality control step.

### CCLE_RNAseq_reads.csv
Pipeline: Expression

RNAseq read count data from RSEM.

- Rows: cell lines (Broad IDs)
- Columns: genes (HGNC symbol and Ensembl ID)

### CCLE_expression_full.csv
Pipeline: Expression

RNAseq TPM gene expression data for all genes using RSEM. Log2 transformed, using a pseudo-count of 1.

- Rows: cell lines (Broad IDs)
- Columns: genes (HGNC symbol and Ensembl ID)

### CCLE_expression.csv
Pipeline: Expression

RNAseq TPM gene expression data for just protein coding genes using RSEM. Log2 transformed, using a pseudo-count of 1.

- Rows: cell lines (Broad IDs)
- Columns: genes (HGNC symbol and Entrez ID)

### CCLE_expression_transcripts_expected_count.csv
Pipeline: Expression

RNAseq read count data from RSEM.

- Rows: cell lines (Broad IDs)
- Columns: transcripts (HGNC symbol and ensembl transcript ID)

### CCLE_expression_proteincoding_genes_expected_count.csv
Pipeline: Expression

RNAseq read count data from RSEM for just protein coding genes.

- Rows: cell lines (Broad IDs)
- Columns: genes (HGNC symbol and Entrez ID)

### CCLE_RNAseq_transcripts.csv
Pipeline: Expression

RNAseq transcript tpm data using RSEM, Log2 transformed, using a pseudo-count of 1.

- Rows: cell lines (Broad IDs)
- Columns: transcripts (HGNC symbol and ensembl transcript ID)

### CCLE_segment_cn.csv
Pipeline: Copy number

Segment level copy number data

- DepMap_ID
- Chromosome
- Start (bp start of the segment)
- End (bp end of the segment)
- Num_Probes (the number of targeting probes that make up this segment)
- Segment_Mean (relative copy ratio for that segment)
- amplification status (+,-,0)

### CCLE_gene_cn.csv
Pipeline: Copy number

Gene level copy number data, log2 transformed with a pseudo count of 1. This is generated by mapping genes onto the segment level calls.

- Rows: cell lines (Broad IDs)
- Columns: genes (HGNC symbol and Entrez ID)

### CCLE_fusions.csv
Pipeline: Fusions

Gene fusion data derived from RNAseq data. Data is filtered using by performing the following:

- Removing fusion involving mitochondrial chromosomes or HLA genes
- Removed common false positive fusions (red herring annotations as described in the STAR-Fusion docs)
- Recurrent fusions observed in CCLE across cell lines (in 10% or more of the samples)
- Removed fusions where SpliceType='INCL_NON_REF_SPLICE' and LargeAnchorSupport='NO_LDAS' and FFPM < 0.1
- FFPM < 0.05

Column descriptions can be found in the STAR-Fusion wiki, except for CCLE_count, which indicates the number of CCLE samples that have this fusion.

### CCLE_fusions_unfiltered.csv
Pipeline: Fusions

Gene fusion data derived from RNAseq data. Data is unfiltered. Column descriptions can be found in the STAR-Fusion wiki

### CCLE_mutations.csv
Pipeline: Mutations

MAF of gene mutations.

For all columns with AC, the allelic ratio is presented as [ALTERNATE:REFERENCE].

- CGA_WES_AC: the allelic ratio for this variant in all our WES/WGS(exon only) using a cell line adapted version of the 2019 CGA pipeline that includes germline filtering.
- SangerWES_AC: in Sanger WES (called by sanger) (legacy)
- SangerRecalibWES_AC: in Sanger WES after realignment at Broad (legacy)
- RNAseq_AC: in Broad RNAseq data from the CCLE2 project (legacy)
- HC_AC: in Broad Hybrid capture data from the CCLE2 project (legacy)
- RD_AC: in Broad Raindance data from the CCLE2 project (legacy)
- legacy_wgs_exon_only: in Broad WGS data from the CCLE2 project (legacy)

Additional columns:

- isTCGAhotspot: is this mutation commonly found in TCGA
- TCGAhsCnt: number of times this mutation is observed in TCGA
- isCOSMIChotspot: is this mutation commonly found in COSMIC
- COSMIChsCnt: number of samples in COSMIC with this mutation
- ExAC_AF: the allelic frequency in the Exome Aggregation Consortium (ExAC)

Descriptions of the remaining columns in the MAF can be found here: https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/

### sample_info.csv

Cell line information definitions

- DepMap_ID: Static primary key assigned by DepMap to each cell line
- stripped_cell_line_name: Cell line name with alphanumeric characters only
- CCLE_Name: Previous naming system that used the stripped cell line name followed by the lineage; no longer assigned to new cell lines
- alias: Additional cell line identifiers (not a comprehensive list)
- COSMIC_ID: Cell line ID used in Cosmic cancer database
- lineage, lineage_subtype, lineage_sub_subtype, lineage_molecular_subtype: Cancer type classifications in a standardized form
- sex: Sex of tissue donor if known
- source: Source of cell line vial used by DepMap
- Achilles_n_replicates: Number of replicates used in Achilles CRISPR screen passing QC
- cell_line_NNMD: Difference in the means of positive and negative controls normalized by the standard deviation of the negative control distribution
- culture_type: Growth pattern of cell line (Adherent, Suspension, Mixed adherent and suspension, 3D, or Adherent (requires laminin coating))
- culture_medium: Medium used to grow cell line
- cas9_activity: Percentage of cells remaining GFP positive on days 12-14 of cas9 activity assay as measured by FACs
- RRID: Cellosaurus research resource identifier
- sample_collection_site: Tissue collection site
- primary_or_metastasis: Indicates whether tissue sample is from primary or metastatic site
- disease: General cancer lineage category
- disease_subtype: Subtype of disease; specific disease name
- age: If known, age of tissue donor at time of sample collection
- Sanger_model_ID: Sanger Institute Cell Model Passport ID
- additional_info: Further information about cell line modifications and drug resistance


